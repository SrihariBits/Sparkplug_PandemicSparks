{"ast":null,"code":"var localStorage = window.hasOwnProperty('localStorage') ? window.localStorage : false;\nimport { loadProject } from '../actions/project-actions';\nvar TIMEOUT_DELAY = 500;\nvar timeout = null;\nexport default function autosave(autosaveKey, delay) {\n  return function (store, stateExtractor) {\n    delay = delay || TIMEOUT_DELAY;\n    if (!autosaveKey) return;\n    if (!localStorage) return; //revert\n\n    if (localStorage.getItem(autosaveKey) !== null) {\n      var data = localStorage.getItem(autosaveKey);\n      var json = JSON.parse(data);\n      store.dispatch(loadProject(json));\n    } //update\n\n\n    store.subscribe(function () {\n      if (timeout) clearTimeout(timeout);\n      timeout = setTimeout(function () {\n        var state = stateExtractor(store.getState());\n        localStorage.setItem(autosaveKey, JSON.stringify(state.scene.toJS()));\n        /*let scene = state.sceneHistory.last;\n        if (scene) {\n          let json = JSON.stringify(scene.toJS());\n          localStorage.setItem(autosaveKey, json);\n        }*/\n      }, delay);\n    });\n  };\n}","map":{"version":3,"sources":["/home/srihari/Desktop/Sparkplug_PandemicSparks/grid/node_modules/react-planner/es/plugins/autosave.js"],"names":["localStorage","window","hasOwnProperty","loadProject","TIMEOUT_DELAY","timeout","autosave","autosaveKey","delay","store","stateExtractor","getItem","data","json","JSON","parse","dispatch","subscribe","clearTimeout","setTimeout","state","getState","setItem","stringify","scene","toJS"],"mappings":"AAAA,IAAIA,YAAY,GAAGC,MAAM,CAACC,cAAP,CAAsB,cAAtB,IAAwCD,MAAM,CAACD,YAA/C,GAA8D,KAAjF;AACA,SAASG,WAAT,QAA4B,4BAA5B;AAEA,IAAIC,aAAa,GAAG,GAApB;AAEA,IAAIC,OAAO,GAAG,IAAd;AAEA,eAAe,SAASC,QAAT,CAAkBC,WAAlB,EAA+BC,KAA/B,EAAsC;AAEnD,SAAO,UAAUC,KAAV,EAAiBC,cAAjB,EAAiC;AAEtCF,IAAAA,KAAK,GAAGA,KAAK,IAAIJ,aAAjB;AAEA,QAAI,CAACG,WAAL,EAAkB;AAClB,QAAI,CAACP,YAAL,EAAmB,OALmB,CAOtC;;AACA,QAAIA,YAAY,CAACW,OAAb,CAAqBJ,WAArB,MAAsC,IAA1C,EAAgD;AAC9C,UAAIK,IAAI,GAAGZ,YAAY,CAACW,OAAb,CAAqBJ,WAArB,CAAX;AACA,UAAIM,IAAI,GAAGC,IAAI,CAACC,KAAL,CAAWH,IAAX,CAAX;AACAH,MAAAA,KAAK,CAACO,QAAN,CAAeb,WAAW,CAACU,IAAD,CAA1B;AACD,KAZqC,CActC;;;AACAJ,IAAAA,KAAK,CAACQ,SAAN,CAAgB,YAAY;AAC1B,UAAIZ,OAAJ,EAAaa,YAAY,CAACb,OAAD,CAAZ;AACbA,MAAAA,OAAO,GAAGc,UAAU,CAAC,YAAY;AAC/B,YAAIC,KAAK,GAAGV,cAAc,CAACD,KAAK,CAACY,QAAN,EAAD,CAA1B;AACArB,QAAAA,YAAY,CAACsB,OAAb,CAAqBf,WAArB,EAAkCO,IAAI,CAACS,SAAL,CAAeH,KAAK,CAACI,KAAN,CAAYC,IAAZ,EAAf,CAAlC;AACA;;;;;AAKD,OARmB,EAQjBjB,KARiB,CAApB;AASD,KAXD;AAYD,GA3BD;AA4BD","sourcesContent":["var localStorage = window.hasOwnProperty('localStorage') ? window.localStorage : false;\nimport { loadProject } from '../actions/project-actions';\n\nvar TIMEOUT_DELAY = 500;\n\nvar timeout = null;\n\nexport default function autosave(autosaveKey, delay) {\n\n  return function (store, stateExtractor) {\n\n    delay = delay || TIMEOUT_DELAY;\n\n    if (!autosaveKey) return;\n    if (!localStorage) return;\n\n    //revert\n    if (localStorage.getItem(autosaveKey) !== null) {\n      var data = localStorage.getItem(autosaveKey);\n      var json = JSON.parse(data);\n      store.dispatch(loadProject(json));\n    }\n\n    //update\n    store.subscribe(function () {\n      if (timeout) clearTimeout(timeout);\n      timeout = setTimeout(function () {\n        var state = stateExtractor(store.getState());\n        localStorage.setItem(autosaveKey, JSON.stringify(state.scene.toJS()));\n        /*let scene = state.sceneHistory.last;\n        if (scene) {\n          let json = JSON.stringify(scene.toJS());\n          localStorage.setItem(autosaveKey, json);\n        }*/\n      }, delay);\n    });\n  };\n}"]},"metadata":{},"sourceType":"module"}